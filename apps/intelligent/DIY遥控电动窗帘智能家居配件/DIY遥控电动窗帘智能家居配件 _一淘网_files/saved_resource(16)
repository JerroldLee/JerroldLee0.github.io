KISSY.add("components/sku/index",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a),b._init()}var e=b.all;return a.extend(d,c,{_init:function(){var a=this,b=a.get("el"),c=b.outerWidth();a.set("skuWidth",c);var d=b.offset().left;a.set("skuLeft",d),a._regSkuEvent(),a._regBtnEvent()},_regSkuEvent:function(){var a=this,b=a.get("el");e(".sku-btn",b).on("click",function(b){var c=e(b.currentTarget),d=e(".sku-cnt",c),f=c.outerWidth();if(c.hasClass("sku-btn-active"))return void c.removeClass("sku-btn-active");var g=a._calMaxItemsWidth(c),h=a._calMaxAllowWidth(c);d.width(f>g?f:g>h?h:g),c.addClass("sku-btn-active")}).on("mouseleave",function(a){var b=e(a.currentTarget);b.removeClass("sku-btn-active")})},_regBtnEvent:function(){var a=this,b=a.get("el");b.delegate("click",".sku-item a",function(a){a.preventDefault();var c=e(a.currentTarget),d=c.parent(".sku-item");if(d.hasClass("sku-item-cur"))return void c.parent(".sku-btn").removeClass("sku-btn-active");var f=c.parent(".sku-list");f.one(".sku-item-cur").removeClass("sku-item-cur"),d.addClass("sku-item-cur");var g=b.all(".sku-item-cur a"),h=b.attr("sku-url")+"&",i="";g.each(function(a){i+=a.attr("sku-property")+";"}),h+="sku_properties="+encodeURIComponent(i),location.href=h})},_calMaxItemsWidth:function(a){for(var b=e(".sku-item",a),c=0,d=b.length,f=0;d>c;c++)f+=e(b[c]).outerWidth()+10;return f+10},_calMaxAllowWidth:function(a){var b=this;return b.get("skuLeft")+b.get("skuWidth")-a.offset().left}},{ATTRS:{el:{value:e(".sku")},skuWidth:{value:420},skuLeft:{value:0}}}),d},{requires:["node","base","./index.css"]});