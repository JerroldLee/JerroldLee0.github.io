KISSY.add("ecc/login/1.0.0/index",function(a,b,c){if(top!==self&&top.ETao&&!top.ETao.needRefresh)try{var d=top.ETao.loginSuccess;top.ETao.Header&&new top.ETao.Header,d&&d()}catch(e){}var f=b.Popup.extend({initializer:function(){},checkTrueLogin:function(){var a="true"==c.get("login"),b=c.get("_nk_"),d=c.get("a_nk");return a&&(b||d)},checkLongOrTrueLogin:function(){var a=c.get("tracknick"),b=c.get("ck1")||c.get("lgc");return this.checkTrueLogin()||a&&b},showLoginPopup:function(){this.show()},show:function(){var a=this,b=window.loginFormPopup;a.get("rendered")?a._display():b?a._display.call(b):a._getContent(function(b){a._display(b),window.loginFormPopup=a})},_display:function(b){var c,d,e=this,f=e.constructor.superclass.show,g="&pre="+escape(window.location.href);f.call(e),e.center(),c=e.get("contentEl"),b&&c.html(b,!0),d=c.all("#J_LoginPopup").attr("login-stat"),a.Stat&&a.Stat("click="+d+g)},_bindEvent:function(){var b=this,c=b.get("el");c.delegate("click",".J_CloseLoginBtn",function(){b.hide()}),c.delegate("click","a",function(b){var c=a.Stat,d=b.currentTarget,e="&pre="+escape(window.location.href),f=a.DOM;b.halt(),c&&(c("click="+f.attr("#J_LoginPopup","login-stat")+e),c("J_TaobaoMember"===d.id?"click="+f.attr("#J_TaobaoMember","login-stat")+e:"click="+f.attr("#J_AlipayMember","login-stat")+e))})},_getContent:function(b){var c=this,d=c.get("scriptUrl");a.getScript(d+"&t="+a.now(),function(){b.call(c,window.LoginPopupHtml)},"utf-8")}},{ATTRS:{prefixCls:{value:"etaologin-"},redirect_url:{value:window.location.href},loginType:{value:"taobao"},isRedirectToA:{value:!1},isCheckLongOrTrueLogin:{value:!0},needRefresh:{value:!0},mask:{value:!0},scriptUrl:{valueFn:function(){var a=!!this.get("needRefresh"),b=this.get("loginType"),c=this.get("redirect_url"),d=-1===location.href.indexOf("etao.net")?"login.etao.com":"login.daily.etao.net";return"//"+d+"/loginpopup_8.html?full_redirect="+a+"&logintype="+b+"&redirect_url="+encodeURIComponent(c)}},listeners:{value:{afterRenderUI:function(){this._bindEvent()},afterCurrentTriggerChange:function(a){var b=this,c=a.newVal,d=b.get("isRedirectToA");c&&d&&b.set("redirect_url",c.attr("href"))}}}},name:"EtaoLogin",timestamp:140120});return f},{requires:["overlay","cookie","event","./index.css"]});