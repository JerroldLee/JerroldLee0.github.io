KISSY.add("components/recommend/index",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a),b._init()}var e=b.all;return a.extend(d,c,{_init:function(){var b=this,c=b.get("el");if(window.data_recommend){b._render(window.data_recommend);var d=window.data_recommend.recommendList.length;d>4&&KISSY.use("gallery/slide/1.3/",function(a,b){var d=new b("J_recommend",{eventType:"click",navClass:"scrollable-trigger",contentClass:"scrollable-panel",pannelClass:"scrollable-content",selectedClass:"current",triggerSelector:"a",autoSlide:!0,effect:"hSlide"});c.one(".slide-next").on("click",function(){d.next()}),c.one(".slide-prev").on("click",function(){d.previous()}),c.on("mouseenter",function(){c.one(".trigger-bar").all("i").show()}).on("mouseleave",function(){c.one(".trigger-bar").all("i").hide()})}),a.all(".user-comment-nocnt")&&a.all(".user-comment-nocnt").addClass("nocnt-bor");var e=1==b.get("n")?"detail_recom1":"detail_recom2";a.one(window).on("scroll",function(){var b=a.one(".recommend").offset().top;if(b){var d=KISSY.one(window).scrollTop();!c.hasClass("is-sent")&&d+a.one(window).height()>b&&(window.EDetail.pv("/tongji","etao_search",window.EDetail.getGokey([e],"/tongji"),"H51884970"),c.addClass("is-sent"))}})}},_render:function(a){var b=this,c=b.get("el"),d="",e=a.recommendList.length,f=Math.ceil(e/4),g=window.clickStat+"&lf_aclog=null-null-null-null-0&stats_click=detail_recom%3A",h=1;if(a.recommendList[0].v2v_more_flag&&(h=0==a.recommendList[0].v2v_more_flag?1:2),b.set("n"),e>4){d+='<div class="trigger-bar">   <a href="javascript:void(0);" data-stat="'+g+"page"+h+'"><i class="iconfont_10 slide-prev">&#983406</i></a>   <a href="javascript:void(0);" data-stat="'+g+"page"+h+'"><i class="iconfont_10 slide-next">&#983405</i></a>   <div class="scrollable-trigger">';for(var i=0;f>i;i++)d+='   <a href="javascript:void(0);" target="_self" data-stat="'+g+"page"+h+'"></a>';d+="</div></div>"}d+='<div class="scrollable-panel"><ul class="scrollable-content">';for(var j=0;e>j;j++)d+=(j+1)%4===1?'<li class="recommend-item first">':'<li class="recommend-item">',d+='   <div class="pic-panel">       <a class="pic bg-loading" href="'+a.recommendList[j].url+'" target="_blank" data-stat="'+g+"pic"+h+'">           <img src="'+a.recommendList[j].img+'" />       </a>   </div>   <div class="info-panel">       <a class="title" rel="uofollow" href="'+a.recommendList[j].url+'" target="_blank" title="'+a.recommendList[j].title+'" data-stat="'+g+"title"+h+'">'+a.recommendList[j].title+'</a>       <div class="price-wrap">           <span class="price"><i class="rmb">&yen;</i>'+a.recommendList[j].price+'</span>       </div>   </div>   <div class="shop-panel">       <span class="shop-name">'+a.recommendList[j].shopName+"</span>   </div></li>",e>j+1&&(j+1)%4===0&&(d+='</ul><ul class="scrollable-content">');d+="</ul></div>",c.one("#J_recommend").html(d)}},{ATTRS:{el:{value:e(".recommend")},n:{value:1}}}),d},{requires:["node","base","./index.css"]});